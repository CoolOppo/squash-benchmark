<!DOCTYPE html>
<html lang="en" ng-app="squashBenchmark">
  <head>
    <meta charset="utf-8">
    <title>Squash Benchmark</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootswatch/3.3.2/sandstone/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.14/angular.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.js"></script>
    <script src="//code.highcharts.com/highcharts.js"></script>

    <style type="text/css">
      .result-bar {
        padding-left: 1em;
        color: black;
        white-space: nowrap;
        text-align: left;
        text-shadow: 0px 0px 1px white;
      }
    </style>
  </head>
  <body ng-controller="SquashBenchmarkCtrl">
    <div class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a href="https://quixdb.github.io/squash" class="navbar-brand">Squash</a>
        </div>

        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="documentation-dropdow">Documentation <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="documentation-dropdown">
                <li><a href="https://quixdb.github.io/squash/man/squash.1.html"><code>squash</code> <abbr title="Command Line Interface">CLI</abbr></a></li>
                <li class="divider"></li>
                <li><a href="https://quixdb.github.io/squash/api/c/index.html">C API Reference</a></li>
                <li><a href="https://quixdb.github.io/squash/api/c/md_docs_user-guide.html">C User Guide</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="support-dropdown">Support <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="support-dropdown">
                <li><a href="https://groups.google.com/forum/#!forum/squash-compression">Mailing List</a></li>
                <li><a href="irc://chat.freenode.net/squash">IRC</a></li>
                <li>
		  <a href="https://stackoverflow.com/questions/tagged/squash-compression">Stack Overflow</a>
		</li>
                <li class="divider"></li>
                <li><a href="https://github.com/quixdb/squash/issues">Issue Tracker</a></li>
              </ul>
            </li>
            <li class="active"><a href="#">Benchmark</a></li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/quixdb/squash"><i class="fa fa-lg fa-github"></i> GitHub</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div style="padding: 3em" class="container bg-danger">
      <h1>WORK IN PROGRESS</h1>

      <p style="font-size: larger">
	This isn't fisished yet.  It should be done in mid to late
	March—please don't spread the link around until it is ready.
	Right now it is just a partial run on {{ machines.length }}
	machines.
      </p>
    </div>

    <div class="container">
      <div class="page-header jumbotron">
	<h1>Squash Benchmark</h1>

	<p>
	  Squash is an abstraction layer for compression algorithms,
	  making it trivial to switch between them… or write a
	  benchmark which tries them all, which is what you see here!
	</p>

	<p>
	  The Squash Benchmark currently consists of {{ datasets.length }}
	  datasets, each of which is tested against {{ plugins.length }}
	  plugins containing {{ codecs.length }} codecs on {{ machines.length }}
	  different computers.  Each algortihm is tested at every
	  compression level it offers—the number varies by codec, but
	  there are in total {{ data_points_per_machine }}, yielding
	  {{ machines.length * data_points_per_machine }} individual
	  pieces of data (minus a handful of failures for
	  resource-intensive codecs on underpowered machines, such as
	  higher LZMA levels on the Raspberry Pi Model B).
	</p>

	<p>
	  <a href="#results" class="btn btn-primary btn-lg">Skip to results (pretty pictures!)</a>
	  <a href="https://quixdb.github.com/squash" class="btn btn-default btn-lg">Learn more about Squash</a>
	</p>
      </div>

      <div id="configuration">
	<h1>Configuration</h1>

	<form>
	  <h2>Choose a dataset</h2>

	  <p>
	    Different codecs can behave <em>very</em> differently with
	    different data.  Some are great at compressing text but
	    horrible with binary data, some excel with more repetitive
	    data like logs.  Many have long initialization times but are
	    fast once they get started, while others can
	    compress/decompress small buffers almost instantly.
	  </p>

	  <p>
	    This benchmark is run against many standard datasets.
	    Hopefully one of them is interesting for you, but if not
	    don't worry—you can use Squash to easily run your own
	    benchmark with whatever data you want.  That said, if you
	    think you have a somewhat common use case,
	    please <a href="https://github.com/quixdb/squash-benchmark/issues">let
	    us know</a>—we may be interested in adding the data to
	    this benchmark.
	  </p>

	  <table class="table table-striped">
	    <thead>
	      <tr>
		<th></th>
		<th ng-click="datasetSortReverse = (datasetSort == 'id') ? !datasetSortReverse : false; datasetSort = 'id'">
		  Name
		  <i ng-if="datasetSort == 'id'" class="fa" ng-class="datasetSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="datasetSortReverse = (datasetSort == 'source') ? !datasetSortReverse : false; datasetSort = 'source'">
		  Source
		  <i ng-if="datasetSort == 'source'" class="fa" ng-class="datasetSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="datasetSortReverse = (datasetSort == 'description') ? !datasetSortReverse : false; datasetSort = 'description'">
		  Description
		  <i ng-if="datasetSort == 'description'" class="fa" ng-class="datasetSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="datasetSortReverse = (datasetSort == 'size') ? !datasetSortReverse : false; datasetSort = 'size'">
		  Size (bytes)
		  <i ng-if="datasetSort == 'size'" class="fa" ng-class="datasetSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
	      </tr>
	    </thead>
	    <tbody>
	      <tr ng-repeat="corpus in datasets | orderBy:datasetSort:datasetSortReverse">
		<td>
		  <input type="radio" name="corpus" ng-value="corpus.id" ng-model="$parent.dataset">
		</td>
		<td>
		  <label for="dataset-{{corpus.id}}" ng-bind="corpus.id"></label>
		</td>
		<td><a ng-href="{{corpus.sourceUrl}}" ng-bind="corpus.source"></a></td>
		<td ng-bind="corpus.description"></td>
		<td ng-bind="corpus.size">}</td>
	      </tr>
	    </tbody>
	  </table>
	</form>

	<div>
	  <h2>Choose a machine</h2>

	  <p>
	    If you think certain algorithms are always faster, you've
	    got another thing coming!  Different CPUs can behave very
	    differently with the same data.
	  </p>

	  <p>
	    The Squash benchmark is currently run on many of the
	    machines I have access to—this happens to be fairly recent
	    Intel CPUs, and a mix of ARM SBCs.
	  </p>

	  <table class="table table-condensed table-striped">
	    <thead>
	      <tr>
		<th></th>
		<th ng-click="machineSortReverse = (machineSort == 'name') ? !machineSortReverse : false; machineSort = 'name'">
		  Hostname
		  <i ng-if="machineSort == 'name'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'cpu') ? !machineSortReverse : false; machineSort = 'cpu'">
		  CPU/SoC
		  <i ng-if="machineSort == 'cpu'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'architecture') ? !machineSortReverse : false; machineSort = 'architecture'">
		  Architecture
		  <i ng-if="machineSort == 'architecture'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'speed') ? !machineSortReverse : false; machineSort = 'speed'">
		  Clock Speed (MHz)
		  <i ng-if="machineSort == 'speed'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'memory') ? !machineSortReverse : false; machineSort = 'memory'">
		  Memory (MB)
		  <i ng-if="machineSort == 'memory'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'platform') ? !machineSortReverse : false; machineSort = 'platform'">
		  Platform
		  <i ng-if="machineSort == 'platform'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'distro') ? !machineSortReverse : false; machineSort = 'distro'">
		  Distro
		  <i ng-if="machineSort == 'distro'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="machineSortReverse = (machineSort == 'kernel') ? !machineSortReverse : false; machineSort = 'kernel'">
		  Kernel
		  <i ng-if="machineSort == 'kernel'" class="fa" ng-class="machineSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
	      </tr>
	    </thead>
	    <tbody>
	      <tr ng-repeat="system in machines | orderBy:machineSort:machineSortReverse">
		<td><input type="radio" name="system" id="dataset-{{system.name}}" value="{{system.name}}"></td>
		<td><label for="dataset-{{system.name}}" ng-bind="system.name"></label></td>
		<td><a ng-href="{{ system.cpuUrl }}" ng-bind="system.cpu"></a></td>
		<td ng-bind="system.architecture"></td>
		<td ng-bind="system.speed"></td>
		<td ng-bind="system.memory"></td>
		<td><a href="{{ system.platformUrl }}" ng-bind="system.platform"></a></td>
		<td ng-bind="system.distro"></td>
		<td ng-bind="system.kernel"></td>
	      </tr>
	    </tbody>
	  </table>
	</div>
      </div>

      <div id="results">
	<h2>Results</h2>

	<div class="panel panel-primary">
	  <div class="panel-heading">
	    <div>
	      <!-- <div class="dropdown" style="float: right"> -->
	      <!-- 	<div id="dLabel" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> -->
	      <!-- 	  <i class="fa fa-cog fa-2x"></i> -->
	      <!-- 	</div> -->
	      <!-- 	<ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dLabel"> -->
	      <!-- 	  <li><a href="#">Compression Speed <i class="fa fa-check"></i></a></li> -->
	      <!-- 	  <li><a href="#">Decompression Speed <i class="fa fa-check"></i></a></li> -->
	      <!-- 	  <li><a href="#">Compression Ratio <i class="fa fa-check"></i></a></li> -->
	      <!-- 	</ul> -->
	      <!-- </div> -->
	      <h3 class="panel-title" style="">Results</h3>
	    </div>
	  </div>

	  <table class="table table-condensed table-striped">
	    <thead>
	      <tr>
		<!-- <th>Show</th> -->
		<th ng-click="rawSortReverse = (rawSort == 'plugin') ? !rawSortReverse : false; rawSort = 'plugin'">
		  Plugin
		  <i ng-if="rawSort == 'plugin'" class="fa" ng-class="rawSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="rawSortReverse = (rawSort == 'codec') ? !rawSortReverse : false; rawSort = 'codec'">
		  Codec
		  <i ng-if="rawSort == 'codec'" class="fa" ng-class="rawSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="rawSortReverse = (rawSort == 'level') ? !rawSortReverse : false; rawSort = 'level'">
		  Level
		  <i ng-if="rawSort == 'level'" class="fa" ng-class="rawSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="rawSortReverse = (rawSort == 'compressed_size') ? !rawSortReverse : false; rawSort = 'compressed_size'">
		  Compression Ratio
		  <i ng-if="rawSort == 'compressed_size'" class="fa" ng-class="rawSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="rawSortReverse = (rawSort == 'compress_cpu') ? !rawSortReverse : false; rawSort = 'compress_cpu'">
		  Compression Speed
		  <i ng-if="rawSort == 'compress_cpu'" class="fa" ng-class="rawSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
		<th ng-click="rawSortReverse = (rawSort == 'decompress_cpu') ? !rawSortReverse : false; rawSort = 'decompress_cpu'">
		  Decompression Speed
		  <i ng-if="rawSort == 'decompress_cpu'" class="fa" ng-class="rawSortReverse ? 'fa-sort-desc' : 'fa-sort-asc'"></i>
		</th>
	      </tr>
	    </thead>

	    <tbody>
	      <tr ng-repeat="result in data | orderBy:rawSort:rawSortReverse">
		<td style="width: 1px; vertical-align: middle" ng-bind="result.plugin"></td>
		<td style="width: 1px; vertical-align: middle" ng-bind="result.codec"></td>
		<td style="width: 1px; vertical-align: middle" ng-bind="result.level"></td>
		<td>
		  <div class="progress" style="margin-bottom: 0">
		    <div class="progress-bar progress-bar-warning result-bar"
			 style="width: {{ ((result.ratio - 1) / (bestRatio - 1)) * 100 }}%">
		      {{ result.ratio | number:2 }}
		    </div>
		  </div>
		</td>
		<td>
		  <div class="progress" style="margin-bottom: 0">
		    <div class="progress-bar progress-bar-info result-bar"
			 style="width: {{ (result.compression_rate / bestCompressionRate) * 100 }}%">
		      {{ result.compression_rate | formatSpeed }}
		    </div>
		  </div>
		</td>
		<td>
		  <div class="progress" style="margin-bottom: 0">
		    <div class="progress-bar progress-bar-success result-bar"
			 style="width: {{ (result.decompression_rate / bestDecompressionRate) * 100 }}%">
		      {{ result.decompression_rate | formatSpeed }}
		    </div>
		  </div>
		</td>
	      </tr>
	    </tbody>
	  </table>
	</div>

	<div class="panel panel-primary">
	  <div class="panel-heading">
	    <h3 class="panel-title">Compression Ratio vs. Compression Speed</h3>
	  </div>

	  <div class="embed-responsive embed-responsive-16by9">
	    <div id="ratio-compression-chart" class="embed-responsive-item panel-body"></div>
	  </div>
	</div>

	<div class="panel panel-primary">
	  <div class="panel-heading">
	    <h3 class="panel-title">Compression Ratio vs. Decompression Speed</h3>
	  </div>


	  <div class="embed-responsive embed-responsive-16by9">
	    <div id="ratio-decompression-chart" class="embed-responsive-item panel-body"></div>
	  </div>
	</div>

	<div class="panel panel-primary">
	  <div class="panel-heading">
	    <h3 class="panel-title">Compression Speed vs. Decompression Speed</h3>
	  </div>

	  <div class="embed-responsive embed-responsive-16by9">
	    <div id="compression-decompression-chart" class="embed-responsive-item panel-body"></div>
	  </div>
	</div>

      </div>
    </div>

    <div id="faq" class="container">
      <h1>FAQ</h1>

      <p>
	Well, okay, I'm writing this before I publish the URL, so not
	so much &quot;frequently asked questions&quot; as &quot;things
	I thought you might be wondering&quot;, but if I called this
	section &quot;TITYMBW&quot; the first thing I would have to
	answer would be &quot;WTF is 'TITYMBW'?&quot;
      </p>

      <dl>
	<dt>Is time CPU time or wall-clock?</dt>
	<dd>
	  CPU time.  Wall-clock data is actually captured but not
	  presented.  I'm willing to consider pull requests if you can
	  find a good way to display it, as well as a good reason.
	</dd>

	<dt>What about multi-threading?</dt>
	<dd>
	  <p>
	    That's a tricky question.  For one thing it would explode
	    the number of data points (for example, LZMA would have 4
	    codecs with 9 levels, multiplied the number the number of
	    cores).  Obviously this would make generating the
	    benchmark even slower, but the main problem is presenting
	    the data in a way which doesn't destroy the usability for
	    people who are interested in single-threaded
	    compression/decompression.
	  </p>
	</dd>

	<dt>What about memory usage?</dt>
	<dd>
	  <p>
	    I would really like to include that data.  If you have a
	    way to integrate that data on the C side (in benchmark.c)
	    I would be very happy to merge it.
	  </p>
	</dd>

	<dt>Can you switch the graphs to use a logarithmic scale?</dt>
	<dd>
	  <p>
	    <em>You</em> can.  Just click on the label for either axis
	    and it will toggle between linear and logarithmic.  I know
	    this isn't obvious—I'd be happy to merge
	    a <abbr title="Pull Request">PR</abbr> if you can improve
	    that.
	  </p>
	</dd>

	<dt>Why isn't <var>«insert compression codec»</var> benchmarked?</dt>
	<dd>
	  <p>
	    Because there isn't
	    a <a href="https://quixdb.github.io/squash">Squash</a>
	    plugin for it, and/or it doesn't work on the machine you
	    selected.
	  </p>
	</dd>

	<dt>Can you add a plugin for <var>«insert compression codec»</var>?</dt>
	<dd>
	  <p>
	    Maybe.  If the codec is reliable (it has to pass Squash's
	    unit tests), works on Linux, accessible from C or C++, and
	    open source the odds are good I would willing to write a
	    plugin or, at the very least, merge a pull request.
	  </p>

	  <p>
	    If the codec doesn't meet the above critera I still might
	    be willing to merge a pull request, but keep in mind that
	    all the machines I run this on are running Linux with
	    various architectures, so even if there is a plugin for a
	    Windows-only, x86-only, etc. it probably will not show up
	    for every machine.  For example, I would like
	    to <a href="https://github.com/quixdb/squash/issues/54">add
	    a Windows API plugin</a>, but it will not show up on any
	    of the Linux machines.
	  </p>
	</dd>

	<dt>Can you add a feature (chart, table, <i>etc.</i>) to the bencmark?</dt>
	<dd>
	  <p>
	    No promises, but I'm willing to at least listen to the
	    request.
	    Please <a href="https://github.com/quixdb/squash-benchmark/issues">file
	    an issue</a>.
	  </p>
	</dd>

	<dt>There are a lot of low-end machines, but what about high-end machines?</dt>
	<dd>
	  <p>
	    Low-end machines are cheaper, and I have a bunch of them
	    sitting around.
	  </p>
	</dd>

	<dt>Can you add  <var>«insert machine, CPU, architecture, OS, etc.»</var>?</dt>
	<dd>
	  <p>
	    Only if I have, or at least have access to, a machine
	    which fits that description.
	  </p>
	</dd>

	<dt>This doesn't work in my browser.</dt>
	<dd>
	  <p>
	    I'm sorry, but if you're using an old browser (probably
	    Internet Explorer) you'll have to upgrade.  I'm willing to
	    consider patches, but I will not be putting in any effort
	    to make this page display in older browsers unless someone
	    wants to pay me to do it—and it's not something I enjoy,
	    so they would have to pay pretty well.
	  </p>
	</dd>

	<dt>Are there any better benchmarks?</dt>
	<dd>
	  <p>
	    There are different benchmarks, which may or may not be
	    better, depending on what you're interested in.  Most
	    benchmarks use command line programs instead of libraries,
	    which is a bit easier so they tend to include many more
	    codecs, but usually don't include nearly as many different
	    machines.  Those benchmarks include:
	  </p>

	  <ul>
	    <li><a href="http://mattmahoney.net/dc/text.html">Large Text Compression Benchmark</a></li>
	    <li><a href="http://www.squeezechart.com/">Squeeze Chart</a></li>
	    <li><a href="http://www.maximumcompression.com/">Maximum Compression</a></li>
	    <li><a href="http://heartofcomp.altervista.org/MOC/MOCA.htm">World Compression Challenge</a></li>
	  </ul>

	  <p>
	    The only other benchmark I'm aware of focusing on
	    libraries
	    is <a href="http://encode.ru/threads/1371-Filesystem-benchmark">fsbench</a>.
	    It includes more compression codecs (though fewer total
	    options), as well as hash functions (cryptographic and
	    non-cryptographic) and some other cryptographic functions.
	    It is run on a few different machines against a tarball of
	    Silesa with all files truncated to 1 MiB.
	  </p>

	  <p>
	    If I'm missing any (modern, up-to-date) benchmarks please
	    let me know.
	  </p>
	</dd>

	<dt>Can I get the raw data?</dt>
	<dd>
	  <p>
	    Sure.  The <abbr title="Comma-separated value">CSV</abbr>s
	    are in
	    the <a href="https://github.com/quixdb/squash-benchmark/tree/gh-pages">gh-pages
	    branch</a> of
	    the <a href="https://github.com/quixdb/squash-benchmark/">squash-benchmark</a>
	    repository.
	  </p>

	  <p>
	    Have fun.  If you do something cool with it please let me know.
	  </p>
	</dd>
      </dl>
    </div>

    <footer class="bg-primary" style="padding: 2em 0">
      <div class="container">
	<p>
	  Generated
	  by <a href="https://github.com/quixdb/squash-benchmark">squash-benchmark</a>
	  using <a href="https://quixdb.github.io/squash">Squash</a>.
	  Please file bug reports and feature requests
	  in <a href="https://github.com/quixdb/squash-benchmark/issues">our
	  issue tracker</a>.
	</p>
      </div>
    </footer>

    <script src="squash-benchmark.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-192022-14', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
